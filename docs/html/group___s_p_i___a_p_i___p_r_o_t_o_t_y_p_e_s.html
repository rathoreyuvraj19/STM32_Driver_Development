<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.15.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>STM32F407 Bare-Metal Driver Development: SPI API Prototypes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">var page_layout=1;</script>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="side-nav" class="ui-resizable side-nav-resizable"><!-- do not remove this div, it is closed by doxygen! -->
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">STM32F407 Bare-Metal Driver Development<span id="projectnumber">&#160;v1.0</span>
   </div>
   <div id="projectbrief">Peripheral driver documentation (GPIO, RCC, EXTI, etc.)</div>
  </td>
 </tr>
   <tr><td colspan="2">        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect" class="search-icon" onmouseover="return searchBox.OnSearchSelectShow()" onmouseout="return searchBox.OnSearchSelectHide()"><span class="search-icon-dropdown"></span></span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><div id="MSearchCloseImg" class="close-icon"></div></a>
          </span>
        </div>
</td></tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.15.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
</div><!-- top -->
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('group___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s.html','',''); });
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search',true);
});
</script>
<div id="main-nav"></div>
<div id="container"><div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">SPI API Prototypes <div class="ingroups"><a class="el" href="group___s_p_i___d_r_i_v_e_r___d_e_v_e_l_o_p_e_m_n_t.html">SPI Driver</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>SPI API Prototypes.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for SPI API Prototypes:</div>
<div class="dyncontent">
<div class="center"><img src="group___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s.png" border="0" usemap="#agroup______s__p__i______a__p__i______p__r__o__t__o__t__y__p__e__s" loading="lazy" alt=""/></div>
<map name="agroup______s__p__i______a__p__i______p__r__o__t__o__t__y__p__e__s" id="agroup______s__p__i______a__p__i______p__r__o__t__o__t__y__p__e__s">
<area shape="rect" title="SPI API Prototypes." alt="" coords="136,5,271,32"/>
<area shape="rect" href="group___s_p_i___d_r_i_v_e_r___d_e_v_e_l_o_p_e_m_n_t.html" title="SPI Driver Development." alt="" coords="5,5,88,32"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab01fdd1c8bc842ad1e9017997c73722c" id="r_gab01fdd1c8bc842ad1e9017997c73722c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#gab01fdd1c8bc842ad1e9017997c73722c">SPIx_Init</a> (<a class="el" href="struct_s_p_ix___handle__t.html">SPIx_Handle_t</a> *pSPI_Handle)</td></tr>
<tr class="memdesc:gab01fdd1c8bc842ad1e9017997c73722c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the SPI peripheral based on the configuration provided in the SPI handle structure.  <br /></td></tr>
<tr class="memitem:ga0864ea8e8f7aaf657d0ba57b60f4227e" id="r_ga0864ea8e8f7aaf657d0ba57b60f4227e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga0864ea8e8f7aaf657d0ba57b60f4227e">SPIx_DeInit</a> (<a class="el" href="struct_s_p_ix___reg_def__t.html">SPIx_RegDef_t</a> *pSPIx)</td></tr>
<tr class="memdesc:ga0864ea8e8f7aaf657d0ba57b60f4227e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resets the SPI peripheral registers to their default reset values.  <br /></td></tr>
<tr class="memitem:ga66a55c39f2954c6fba416822612497cb" id="r_ga66a55c39f2954c6fba416822612497cb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga66a55c39f2954c6fba416822612497cb">SPIx_Peri_Control</a> (<a class="el" href="struct_s_p_ix___reg_def__t.html">SPIx_RegDef_t</a> *pSPIx, uint8_t EN_DI)</td></tr>
<tr class="memdesc:ga66a55c39f2954c6fba416822612497cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enables or disables the SPI peripheral.  <br /></td></tr>
<tr class="memitem:ga28c21c2e8a6f53982ec6666fb0969123" id="r_ga28c21c2e8a6f53982ec6666fb0969123"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga28c21c2e8a6f53982ec6666fb0969123">SPIx_GetFlagStatus</a> (<a class="el" href="struct_s_p_ix___reg_def__t.html">SPIx_RegDef_t</a> *pSPIx, uint32_t FlagName)</td></tr>
<tr class="memdesc:ga28c21c2e8a6f53982ec6666fb0969123"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads the status of a specific SPI status flag.  <br /></td></tr>
<tr class="memitem:ga2f1a0a4006270d72092844c3e764d399" id="r_ga2f1a0a4006270d72092844c3e764d399"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ga2f1a0a4006270d72092844c3e764d399">SPIx_SendData_Blocking</a> (<a class="el" href="struct_s_p_ix___reg_def__t.html">SPIx_RegDef_t</a> *pSPIx, uint8_t *pData, uint32_t Len)</td></tr>
<tr class="memdesc:ga2f1a0a4006270d72092844c3e764d399"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data over the specified SPI peripheral.  <br /></td></tr>
</table>
<a name="details" id="details"></a><h2 id="header-details" class="groupheader">Detailed Description</h2>
<p>SPI API Prototypes. </p>
<dl class="section note"><dt>Note</dt><dd>Contains SPI API Prototypes </dd></dl>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="ga0864ea8e8f7aaf657d0ba57b60f4227e" name="ga0864ea8e8f7aaf657d0ba57b60f4227e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0864ea8e8f7aaf657d0ba57b60f4227e">&#9670;&#160;</a></span>SPIx_DeInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIx_DeInit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_p_ix___reg_def__t.html">SPIx_RegDef_t</a> *</td>          <td class="paramname"><span class="paramname"><em>pSPIx</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resets the SPI peripheral registers to their default reset values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pSPIx</td><td>: Pointer to the SPI peripheral base address (e.g., SPI1, SPI2, SPI3).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function uses the RCC reset mechanism to reset the peripheral. After reset, the SPI clock is automatically disabled.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>None </dd></dl>
<ol type="1">
<li>Disable peripheral clock to save power</li>
</ol>

<p class="definition">Definition at line <a class="el" href="stm32f407xx__spi_8c_source.html#l00093">93</a> of file <a class="el" href="stm32f407xx__spi_8c_source.html">stm32f407xx_spi.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>{</div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_struct" href="struct_r_c_c___reg_def__t.html">RCC_RegDef_t</a> *pRCC = <a class="code hl_define" href="group___r_c_c___r_e_g.html#ga74944438a086975793d26ae48d5882d4">RCC</a>;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">if</span> (pSPIx == <a class="code hl_define" href="group___s_p_i___instances.html#gad483be344a28ac800be8f03654a9612f">SPI1</a>)</div>
<div class="line"><span class="lineno">   98</span>    {</div>
<div class="line"><span class="lineno">   99</span>        pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#a6c1588013b885c32b78b912e8249a26c">APB2RSTR</a> |=  (1 &lt;&lt; 12);   <span class="comment">// Force reset</span></div>
<div class="line"><span class="lineno">  100</span>        pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#a6c1588013b885c32b78b912e8249a26c">APB2RSTR</a> &amp;= ~(1 &lt;&lt; 12);   <span class="comment">// Release reset</span></div>
<div class="line"><span class="lineno">  101</span>    }</div>
<div class="line"><span class="lineno">  102</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pSPIx == <a class="code hl_define" href="group___s_p_i___instances.html#gaf2c3d8ce359dcfbb2261e07ed42af72b">SPI2</a>)</div>
<div class="line"><span class="lineno">  103</span>    {</div>
<div class="line"><span class="lineno">  104</span>        pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#acfa79aca8487958412be8f32e4632b47">APB1RSTR</a> |=  (1 &lt;&lt; 14);   <span class="comment">// Force reset</span></div>
<div class="line"><span class="lineno">  105</span>        pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#acfa79aca8487958412be8f32e4632b47">APB1RSTR</a> &amp;= ~(1 &lt;&lt; 14);   <span class="comment">// Release reset</span></div>
<div class="line"><span class="lineno">  106</span>    }</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pSPIx == <a class="code hl_define" href="group___s_p_i___instances.html#gab2339cbf25502bf562b19208b1b257fc">SPI3</a>)</div>
<div class="line"><span class="lineno">  108</span>    {</div>
<div class="line"><span class="lineno">  109</span>        pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#acfa79aca8487958412be8f32e4632b47">APB1RSTR</a> |=  (1 &lt;&lt; 15);   <span class="comment">// Force reset</span></div>
<div class="line"><span class="lineno">  110</span>        pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#acfa79aca8487958412be8f32e4632b47">APB1RSTR</a> &amp;= ~(1 &lt;&lt; 15);   <span class="comment">// Release reset</span></div>
<div class="line"><span class="lineno">  111</span>    }</div>
<div class="line"><span class="lineno">  112</span></div>
<div class="line"><span class="lineno">  114</span>       <span class="keywordflow">if</span> (pSPIx == <a class="code hl_define" href="group___s_p_i___instances.html#gad483be344a28ac800be8f03654a9612f">SPI1</a>)</div>
<div class="line"><span class="lineno">  115</span>       {</div>
<div class="line"><span class="lineno">  116</span>           pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#aa5211a53246098ec97c0e360759c5ad8">APB2ENR</a> &amp;= ~(1 &lt;&lt; 12);</div>
<div class="line"><span class="lineno">  117</span>       }</div>
<div class="line"><span class="lineno">  118</span>       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pSPIx == <a class="code hl_define" href="group___s_p_i___instances.html#gaf2c3d8ce359dcfbb2261e07ed42af72b">SPI2</a>)</div>
<div class="line"><span class="lineno">  119</span>       {</div>
<div class="line"><span class="lineno">  120</span>           pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#a389643cd117089ebb8dd10ec060488d8">APB1ENR</a> &amp;= ~(1 &lt;&lt; 14);</div>
<div class="line"><span class="lineno">  121</span>       }</div>
<div class="line"><span class="lineno">  122</span>       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pSPIx == <a class="code hl_define" href="group___s_p_i___instances.html#gab2339cbf25502bf562b19208b1b257fc">SPI3</a>)</div>
<div class="line"><span class="lineno">  123</span>       {</div>
<div class="line"><span class="lineno">  124</span>           pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#a389643cd117089ebb8dd10ec060488d8">APB1ENR</a> &amp;= ~(1 &lt;&lt; 15);</div>
<div class="line"><span class="lineno">  125</span>       }</div>
<div class="line"><span class="lineno">  126</span>}</div>
<div class="ttc" id="agroup___r_c_c___r_e_g_html_ga74944438a086975793d26ae48d5882d4"><div class="ttname"><a href="group___r_c_c___r_e_g.html#ga74944438a086975793d26ae48d5882d4">RCC</a></div><div class="ttdeci">#define RCC</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00312">stm32f407xx.h:312</a></div></div>
<div class="ttc" id="agroup___s_p_i___instances_html_gab2339cbf25502bf562b19208b1b257fc"><div class="ttname"><a href="group___s_p_i___instances.html#gab2339cbf25502bf562b19208b1b257fc">SPI3</a></div><div class="ttdeci">#define SPI3</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00743">stm32f407xx.h:743</a></div></div>
<div class="ttc" id="agroup___s_p_i___instances_html_gad483be344a28ac800be8f03654a9612f"><div class="ttname"><a href="group___s_p_i___instances.html#gad483be344a28ac800be8f03654a9612f">SPI1</a></div><div class="ttdeci">#define SPI1</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00741">stm32f407xx.h:741</a></div></div>
<div class="ttc" id="agroup___s_p_i___instances_html_gaf2c3d8ce359dcfbb2261e07ed42af72b"><div class="ttname"><a href="group___s_p_i___instances.html#gaf2c3d8ce359dcfbb2261e07ed42af72b">SPI2</a></div><div class="ttdeci">#define SPI2</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00742">stm32f407xx.h:742</a></div></div>
<div class="ttc" id="astruct_r_c_c___reg_def__t_html"><div class="ttname"><a href="struct_r_c_c___reg_def__t.html">RCC_RegDef_t</a></div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00275">stm32f407xx.h:275</a></div></div>
<div class="ttc" id="astruct_r_c_c___reg_def__t_html_a389643cd117089ebb8dd10ec060488d8"><div class="ttname"><a href="struct_r_c_c___reg_def__t.html#a389643cd117089ebb8dd10ec060488d8">RCC_RegDef_t::APB1ENR</a></div><div class="ttdeci">volatile uint32_t APB1ENR</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00292">stm32f407xx.h:292</a></div></div>
<div class="ttc" id="astruct_r_c_c___reg_def__t_html_a6c1588013b885c32b78b912e8249a26c"><div class="ttname"><a href="struct_r_c_c___reg_def__t.html#a6c1588013b885c32b78b912e8249a26c">RCC_RegDef_t::APB2RSTR</a></div><div class="ttdeci">volatile uint32_t APB2RSTR</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00285">stm32f407xx.h:285</a></div></div>
<div class="ttc" id="astruct_r_c_c___reg_def__t_html_aa5211a53246098ec97c0e360759c5ad8"><div class="ttname"><a href="struct_r_c_c___reg_def__t.html#aa5211a53246098ec97c0e360759c5ad8">RCC_RegDef_t::APB2ENR</a></div><div class="ttdeci">volatile uint32_t APB2ENR</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00293">stm32f407xx.h:293</a></div></div>
<div class="ttc" id="astruct_r_c_c___reg_def__t_html_acfa79aca8487958412be8f32e4632b47"><div class="ttname"><a href="struct_r_c_c___reg_def__t.html#acfa79aca8487958412be8f32e4632b47">RCC_RegDef_t::APB1RSTR</a></div><div class="ttdeci">volatile uint32_t APB1RSTR</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00284">stm32f407xx.h:284</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga28c21c2e8a6f53982ec6666fb0969123" name="ga28c21c2e8a6f53982ec6666fb0969123"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga28c21c2e8a6f53982ec6666fb0969123">&#9670;&#160;</a></span>SPIx_GetFlagStatus()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t SPIx_GetFlagStatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_p_ix___reg_def__t.html">SPIx_RegDef_t</a> *</td>          <td class="paramname"><span class="paramname"><em>pSPIx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>FlagName</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads the status of a specific SPI status flag. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pSPIx[in]</td><td>: Pointer to the SPI peripheral base address (e.g., SPI1, SPI2, SPI3).</td></tr>
    <tr><td class="paramname">FlagName[in]</td><td>: Name of the flag to check. This must be one of the predefined SPI flag macros, such as:<ul>
<li>SPI_TXE_FLAG</li>
<li>SPI_RXNE_FLAG</li>
<li>SPI_BUSY_FLAG <a class="el" href="group___s_p_i___s_t_a_t_u_s___f_l_a_g___m_a_c_r_o_s.html">SPI Status Flag Macros</a></li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function reads the SPI_SR register and checks the bit corresponding to the selected flag.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>uint8_t : FLAG_SET (1) if the flag is set FLAG_RESET (0) if the flag is cleared </dd></dl>

<p class="definition">Definition at line <a class="el" href="stm32f407xx__spi_8c_source.html#l00141">141</a> of file <a class="el" href="stm32f407xx__spi_8c_source.html">stm32f407xx_spi.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  141</span>                                                                    {</div>
<div class="line"><span class="lineno">  142</span>    <span class="keywordflow">return</span> (uint8_t) (((pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#a8beaebfb019b994f6de84acfde02c350">SR</a>) &gt;&gt; FlagName) &amp; (0x01U));</div>
<div class="line"><span class="lineno">  143</span>}</div>
<div class="ttc" id="astruct_s_p_ix___reg_def__t_html_a8beaebfb019b994f6de84acfde02c350"><div class="ttname"><a href="struct_s_p_ix___reg_def__t.html#a8beaebfb019b994f6de84acfde02c350">SPIx_RegDef_t::SR</a></div><div class="ttdeci">volatile uint32_t SR</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00724">stm32f407xx.h:724</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga28c21c2e8a6f53982ec6666fb0969123_icgraph.png" border="0" usemap="#agroup___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga28c21c2e8a6f53982ec6666fb0969123_icgraph" loading="lazy" alt=""/></div>
<map name="agroup___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga28c21c2e8a6f53982ec6666fb0969123_icgraph" id="agroup___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga28c21c2e8a6f53982ec6666fb0969123_icgraph">
<area shape="rect" title="Reads the status of a specific SPI status flag." alt="" coords="226,31,367,57"/>
<area shape="rect" href="group___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s.html#ga66a55c39f2954c6fba416822612497cb" title="Enables or disables the SPI peripheral." alt="" coords="27,5,156,32"/>
<area shape="poly" title=" " alt="" coords="210,36,156,29,157,24,211,31"/>
<area shape="rect" href="group___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s.html#ga2f1a0a4006270d72092844c3e764d399" title="Send data over the specified SPI peripheral." alt="" coords="5,56,178,83"/>
<area shape="poly" title=" " alt="" coords="211,57,179,61,178,56,210,52"/>
</map>
</div>

</div>
</div>
<a id="gab01fdd1c8bc842ad1e9017997c73722c" name="gab01fdd1c8bc842ad1e9017997c73722c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab01fdd1c8bc842ad1e9017997c73722c">&#9670;&#160;</a></span>SPIx_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIx_Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_p_ix___handle__t.html">SPIx_Handle_t</a> *</td>          <td class="paramname"><span class="paramname"><em>pSPI_Handle</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the SPI peripheral based on the configuration provided in the SPI handle structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pSPI_Handle</td><td>: Pointer to SPI handle structure which contains SPI register base address and SPI configuration settings.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function does NOT enable the SPI peripheral. It only configures the control registers. User must call SPIx_PeripheralControl() to enable the peripheral after initialization.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>None </dd></dl>
<ol type="1">
<li>Enable the SPIx peripheral clock Through RCC</li>
</ol>
<p>Enable the SPI1 RCC APB2ENR reg</p>
<p>Enable the SPI2 RCC APB1ENR reg</p>
<p>Enable the SPI3 RCC APB1ENR reg</p>
<ol type="1">
<li>Set Device Mode Master/Slave (MSTR) <br  />
</li>
</ol>
<ol type="1">
<li>Set Bus Mode (Full Duplex/Half Duplex/Simplex) <br  />
</li>
</ol>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000066">Todo</a></b></dt><dd>Implement later you should make seperate API for BIDIOE Bit </dd></dl>
<p>Clear this bit and use RX only for setting </p><dl class="section note"><dt>Note</dt><dd>Master can be in RX only mode as well, its not necessary that master has to be in TX only in Simplex mode </dd>
<dd>
For simplex mode BIDIMODE Bit has to be Cleared</dd></dl>
<ol type="1">
<li>Select the BR[2:0] bits to define the serial clock baud rate (see SPI_CR1 register).</li>
</ol>
<p>&lt; Clear the bits BR[2:0] first</p>
<p>&lt; Set the bits <a class="el" href="group___s_p_i___c_l_o_c_k___s_p_e_e_d___m_a_c_r_o_s.html">SPI Clock Speed Macros</a></p>
<ol type="1">
<li>Select the CPOL and CPHA bits to define one of the four relationships between the data transfer and the serial clock (see Figure 248). This step is not required when the TI mode is selected.</li>
</ol>
<p>&lt; Clear CPHA</p>
<p>&lt; Clear CPOL</p>
<p>&lt; Set CPHA</p>
<p>&lt; Set CPOL</p>
<ol type="1">
<li>Set the DFF bit to define 8- or 16-bit data frame format</li>
</ol>
<p>&lt; Clear DFF</p>
<p>&lt; Set DFF</p>
<ol type="1">
<li>Configure the LSBFIRST bit in the SPI_CR1 register to define the frame format.</li>
</ol>
<ol type="1">
<li>If the NSS pin is required in input mode, in hardware mode, connect the NSS pin to a high-level signal during the complete byte transmit sequence. In NSS software mode, set the SSM and SSI bits in the SPI_CR1 register. If the NSS pin is required in output mode, the SSOE bit only should be set. This step is not required when the TI mode is selected.</li>
</ol>
<ol type="1">
<li>Set the FRF bit in SPI_CR2 to select the TI protocol for serial communications</li>
</ol>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000067">Todo</a></b></dt><dd>implement CRC_EN and FRF </dd></dl>

<p class="definition">Definition at line <a class="el" href="stm32f407xx__spi_8c_source.html#l00010">10</a> of file <a class="el" href="stm32f407xx__spi_8c_source.html">stm32f407xx_spi.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   10</span>                                          {</div>
<div class="line"><span class="lineno">   11</span>    <a class="code hl_struct" href="struct_s_p_ix___reg_def__t.html">SPIx_RegDef_t</a>* pSPIx = pSPI_Handle-&gt;<a class="code hl_variable" href="struct_s_p_ix___handle__t.html#a2139a08270d0669a4bfd52184169f444">pSPIx</a>;</div>
<div class="line"><span class="lineno">   12</span>    uint8_t SPI_DEVICE_MODE = pSPI_Handle-&gt;<a class="code hl_variable" href="struct_s_p_ix___handle__t.html#ad8dfc166a5c690bfebcc6e855132e805">SPI_CONFIG</a>.<a class="code hl_variable" href="struct_s_p_ix___config__t.html#a58ec8a46f301546f865e2e7477bf3d8f">SPI_DEVICE_MODE</a>;</div>
<div class="line"><span class="lineno">   13</span>    uint8_t SPI_BUS_MODE = pSPI_Handle-&gt;<a class="code hl_variable" href="struct_s_p_ix___handle__t.html#ad8dfc166a5c690bfebcc6e855132e805">SPI_CONFIG</a>.<a class="code hl_variable" href="struct_s_p_ix___config__t.html#a0d54bb16c7b59c8894f9c27f2061c232">SPI_BUS_MODE</a>;</div>
<div class="line"><span class="lineno">   14</span>    uint8_t SPI_CLOCK_SPEED = pSPI_Handle-&gt;<a class="code hl_variable" href="struct_s_p_ix___handle__t.html#ad8dfc166a5c690bfebcc6e855132e805">SPI_CONFIG</a>.<a class="code hl_variable" href="struct_s_p_ix___config__t.html#a192d86623e71d56bbbbf99b8efffd298">SPI_CLOCK_SPEED</a>;</div>
<div class="line"><span class="lineno">   15</span>    uint8_t SPI_CPOL = pSPI_Handle-&gt;<a class="code hl_variable" href="struct_s_p_ix___handle__t.html#ad8dfc166a5c690bfebcc6e855132e805">SPI_CONFIG</a>.<a class="code hl_variable" href="struct_s_p_ix___config__t.html#a908cc1f30a9b3d2603b9c904fa16087b">SPI_CPOL</a>;</div>
<div class="line"><span class="lineno">   16</span>    uint8_t SPI_CPHA = pSPI_Handle-&gt;<a class="code hl_variable" href="struct_s_p_ix___handle__t.html#ad8dfc166a5c690bfebcc6e855132e805">SPI_CONFIG</a>.<a class="code hl_variable" href="struct_s_p_ix___config__t.html#aa1c544b092454a095481cce8672dd4d5">SPI_CPHA</a>;</div>
<div class="line"><span class="lineno">   17</span>    uint8_t SPI_FRAME_SIZE = pSPI_Handle-&gt;<a class="code hl_variable" href="struct_s_p_ix___handle__t.html#ad8dfc166a5c690bfebcc6e855132e805">SPI_CONFIG</a>.<a class="code hl_variable" href="struct_s_p_ix___config__t.html#a649f465ce3b2a3c787a6f5495770e1fa">SPI_FRAME_SIZE</a>;</div>
<div class="line"><span class="lineno">   18</span>    uint8_t SPI_SSM_SETTING = pSPI_Handle-&gt;<a class="code hl_variable" href="struct_s_p_ix___handle__t.html#ad8dfc166a5c690bfebcc6e855132e805">SPI_CONFIG</a>.<a class="code hl_variable" href="struct_s_p_ix___config__t.html#a9d287666eb349733ac55fd6317aa7cc3">SPI_SSM_SETTING</a>;</div>
<div class="line"><span class="lineno">   19</span>    uint8_t SPI_BIT_ORDER = pSPI_Handle-&gt;<a class="code hl_variable" href="struct_s_p_ix___handle__t.html#ad8dfc166a5c690bfebcc6e855132e805">SPI_CONFIG</a>.<a class="code hl_variable" href="struct_s_p_ix___config__t.html#a36304b6c78174800ccd32eb837da0754">SPI_BIT_ORDER</a>;</div>
<div class="line"><span class="lineno">   20</span>    uint8_t SPI_SSOE = pSPI_Handle-&gt;<a class="code hl_variable" href="struct_s_p_ix___handle__t.html#ad8dfc166a5c690bfebcc6e855132e805">SPI_CONFIG</a>.<a class="code hl_variable" href="struct_s_p_ix___config__t.html#a57dd078d1351d4a0a54b79ea5a2e08cb">SPI_SSOE</a>;</div>
<div class="line"><span class="lineno">   21</span>    uint8_t SPI_CRC_EN = pSPI_Handle-&gt;<a class="code hl_variable" href="struct_s_p_ix___handle__t.html#ad8dfc166a5c690bfebcc6e855132e805">SPI_CONFIG</a>.<a class="code hl_variable" href="struct_s_p_ix___config__t.html#a207736f784d8a45e51344760a1e2163f">SPI_CRC_EN</a>;</div>
<div class="line"><span class="lineno">   22</span></div>
<div class="line"><span class="lineno">   24</span>    <a class="code hl_struct" href="struct_r_c_c___reg_def__t.html">RCC_RegDef_t</a>* pRCC = <a class="code hl_define" href="group___r_c_c___r_e_g.html#ga74944438a086975793d26ae48d5882d4">RCC</a>;</div>
<div class="line"><span class="lineno">   25</span>    <span class="keywordflow">if</span>(pSPIx == <a class="code hl_define" href="group___s_p_i___instances.html#gad483be344a28ac800be8f03654a9612f">SPI1</a>){ </div>
<div class="line"><span class="lineno">   26</span>        pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#aa5211a53246098ec97c0e360759c5ad8">APB2ENR</a> |= (1 &lt;&lt; 12);</div>
<div class="line"><span class="lineno">   27</span>    }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(pSPIx == <a class="code hl_define" href="group___s_p_i___instances.html#gaf2c3d8ce359dcfbb2261e07ed42af72b">SPI2</a>){</div>
<div class="line"><span class="lineno">   28</span>        pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#a389643cd117089ebb8dd10ec060488d8">APB1ENR</a> |= (1 &lt;&lt; 14);</div>
<div class="line"><span class="lineno">   29</span>    }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(pSPIx == <a class="code hl_define" href="group___s_p_i___instances.html#gab2339cbf25502bf562b19208b1b257fc">SPI3</a>){</div>
<div class="line"><span class="lineno">   30</span>        pRCC-&gt;<a class="code hl_variable" href="struct_r_c_c___reg_def__t.html#a389643cd117089ebb8dd10ec060488d8">APB1ENR</a> |= (1 &lt;&lt; 15);</div>
<div class="line"><span class="lineno">   31</span>    }</div>
<div class="line"><span class="lineno">   32</span></div>
<div class="line"><span class="lineno">   34</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp;= ~(1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga27567886a2c76d088e01ad16851cdb71">SPI_CR1_MSTR_Pos</a>);</div>
<div class="line"><span class="lineno">   35</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> |= (SPI_DEVICE_MODE &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga27567886a2c76d088e01ad16851cdb71">SPI_CR1_MSTR_Pos</a>);</div>
<div class="line"><span class="lineno">   36</span></div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordflow">if</span> (SPI_BUS_MODE == <a class="code hl_define" href="group___s_p_i___b_u_s___m_o_d_e___m_a_c_r_o_s.html#gaaee1a51a51147bb752571735e6895d00">SPI_BUS_MODE_FULL_DUPLEX</a>) { <span class="comment">// Normal Mode</span></div>
<div class="line"><span class="lineno">   39</span>        <span class="comment">//Clear BIDIMODE Bit in CR1 Reg</span></div>
<div class="line"><span class="lineno">   40</span>        pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp;= ~(1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gab07c9facbfdb0a7d5d89b1fd6a3ef711">SPI_CR1_BIDIMODE_Pos</a>);</div>
<div class="line"><span class="lineno">   41</span>        <span class="comment">// Also Clear the RXONLY Bit just for safety</span></div>
<div class="line"><span class="lineno">   42</span>        pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp;= ~(1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gadd702fae4dcca65f3b43b2e02f67ee7b">SPI_CR1_RXONLY_Pos</a>);</div>
<div class="line"><span class="lineno">   43</span>    }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(SPI_BUS_MODE == <a class="code hl_define" href="group___s_p_i___b_u_s___m_o_d_e___m_a_c_r_o_s.html#ga1997337ed2896a4722b16affed5ec968">SPI_BUS_MODE_HALF_DUPLEX</a>){</div>
<div class="line"><span class="lineno">   44</span>        <span class="comment">//Set BIDIMODE Bit in CR1 Reg</span></div>
<div class="line"><span class="lineno">   46</span>        pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> |= (1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gab07c9facbfdb0a7d5d89b1fd6a3ef711">SPI_CR1_BIDIMODE_Pos</a>);</div>
<div class="line"><span class="lineno">   47</span>    }<span class="keywordflow">else</span> <span class="keywordflow">if</span>(SPI_BUS_MODE == <a class="code hl_define" href="group___s_p_i___b_u_s___m_o_d_e___m_a_c_r_o_s.html#ga86c645f38e8da84614a462968ddf0554">SPI_BUS_MODE_SIMPLEX_RX</a>){<span class="comment">// Simplex Means either Tx only or Rx Only</span></div>
<div class="line"><span class="lineno">   52</span>        pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp;= ~(1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gab07c9facbfdb0a7d5d89b1fd6a3ef711">SPI_CR1_BIDIMODE_Pos</a>);</div>
<div class="line"><span class="lineno">   53</span>        pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> |= (1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gadd702fae4dcca65f3b43b2e02f67ee7b">SPI_CR1_RXONLY_Pos</a>);</div>
<div class="line"><span class="lineno">   54</span>    }</div>
<div class="line"><span class="lineno">   55</span></div>
<div class="line"><span class="lineno">   57</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp;= ~(0x07 &lt;&lt; 3); </div>
<div class="line"><span class="lineno">   58</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> |= (SPI_CLOCK_SPEED &lt;&lt; 3); </div>
<div class="line"><span class="lineno">   59</span></div>
<div class="line"><span class="lineno">   64</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp;= ~(1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga2f1d2c5a9e481ca06d0e29332f6f948a">SPI_CR1_CPHA_Pos</a>);     </div>
<div class="line"><span class="lineno">   65</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp;= ~(1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gadd3274c0dce6293370773c5050f9c4be">SPI_CR1_CPOL_Pos</a>);     </div>
<div class="line"><span class="lineno">   66</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> |= (SPI_CPHA &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga2f1d2c5a9e481ca06d0e29332f6f948a">SPI_CR1_CPHA_Pos</a>);       </div>
<div class="line"><span class="lineno">   67</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> |= (SPI_CPOL &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gadd3274c0dce6293370773c5050f9c4be">SPI_CR1_CPOL_Pos</a>);       </div>
<div class="line"><span class="lineno">   68</span></div>
<div class="line"><span class="lineno">   70</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp;= ~(1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga5290662db14690d4bcf30ed9e4694462">SPI_CR1_DFF_Pos</a>); </div>
<div class="line"><span class="lineno">   71</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> |= (SPI_FRAME_SIZE &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga5290662db14690d4bcf30ed9e4694462">SPI_CR1_DFF_Pos</a>); </div>
<div class="line"><span class="lineno">   72</span></div>
<div class="line"><span class="lineno">   74</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp;= ~(1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga982b564879d1dc60a3be787409df0c27">SPI_CR1_LSBFIRST_Pos</a>);</div>
<div class="line"><span class="lineno">   75</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> |= (SPI_BIT_ORDER &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga982b564879d1dc60a3be787409df0c27">SPI_CR1_LSBFIRST_Pos</a>);</div>
<div class="line"><span class="lineno">   76</span></div>
<div class="line"><span class="lineno">   83</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp;= ~(1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gab2909290fab17ee930afc335811f574c">SPI_CR1_SSM_Pos</a>); <span class="comment">// Clear the SSM Bit in CR1 Reg</span></div>
<div class="line"><span class="lineno">   84</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> |= (SPI_SSM_SETTING &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gab2909290fab17ee930afc335811f574c">SPI_CR1_SSM_Pos</a>);<span class="comment">// Set the bit</span></div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ae19a6b4335672191e29e0e1526e27fb0">CR2</a> &amp;= ~(1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r2___b_i_t___p_o_s_i_t_i_o_n_s.html#gaa0d0f5f51a5804e1a204bf1643516896">SPI_CR2_SSOE_Pos</a>); <span class="comment">// Clear the SSOE Bit in CR2 Reg</span></div>
<div class="line"><span class="lineno">   87</span>    pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ae19a6b4335672191e29e0e1526e27fb0">CR2</a> |= (SPI_SSOE &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r2___b_i_t___p_o_s_i_t_i_o_n_s.html#gaa0d0f5f51a5804e1a204bf1643516896">SPI_CR2_SSOE_Pos</a>);<span class="comment">// Set the bit</span></div>
<div class="line"><span class="lineno">   88</span></div>
<div class="line"><span class="lineno">   91</span>}</div>
<div class="ttc" id="agroup___s_p_i___b_u_s___m_o_d_e___m_a_c_r_o_s_html_ga1997337ed2896a4722b16affed5ec968"><div class="ttname"><a href="group___s_p_i___b_u_s___m_o_d_e___m_a_c_r_o_s.html#ga1997337ed2896a4722b16affed5ec968">SPI_BUS_MODE_HALF_DUPLEX</a></div><div class="ttdeci">#define SPI_BUS_MODE_HALF_DUPLEX</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00041">stm32f407xx_spi.h:41</a></div></div>
<div class="ttc" id="agroup___s_p_i___b_u_s___m_o_d_e___m_a_c_r_o_s_html_ga86c645f38e8da84614a462968ddf0554"><div class="ttname"><a href="group___s_p_i___b_u_s___m_o_d_e___m_a_c_r_o_s.html#ga86c645f38e8da84614a462968ddf0554">SPI_BUS_MODE_SIMPLEX_RX</a></div><div class="ttdeci">#define SPI_BUS_MODE_SIMPLEX_RX</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00042">stm32f407xx_spi.h:42</a></div></div>
<div class="ttc" id="agroup___s_p_i___b_u_s___m_o_d_e___m_a_c_r_o_s_html_gaaee1a51a51147bb752571735e6895d00"><div class="ttname"><a href="group___s_p_i___b_u_s___m_o_d_e___m_a_c_r_o_s.html#gaaee1a51a51147bb752571735e6895d00">SPI_BUS_MODE_FULL_DUPLEX</a></div><div class="ttdeci">#define SPI_BUS_MODE_FULL_DUPLEX</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00040">stm32f407xx_spi.h:40</a></div></div>
<div class="ttc" id="agroup___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s_html_ga27567886a2c76d088e01ad16851cdb71"><div class="ttname"><a href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga27567886a2c76d088e01ad16851cdb71">SPI_CR1_MSTR_Pos</a></div><div class="ttdeci">#define SPI_CR1_MSTR_Pos</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00379">stm32f407xx_spi.h:379</a></div></div>
<div class="ttc" id="agroup___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s_html_ga2f1d2c5a9e481ca06d0e29332f6f948a"><div class="ttname"><a href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga2f1d2c5a9e481ca06d0e29332f6f948a">SPI_CR1_CPHA_Pos</a></div><div class="ttdeci">#define SPI_CR1_CPHA_Pos</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00377">stm32f407xx_spi.h:377</a></div></div>
<div class="ttc" id="agroup___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s_html_ga5290662db14690d4bcf30ed9e4694462"><div class="ttname"><a href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga5290662db14690d4bcf30ed9e4694462">SPI_CR1_DFF_Pos</a></div><div class="ttdeci">#define SPI_CR1_DFF_Pos</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00386">stm32f407xx_spi.h:386</a></div></div>
<div class="ttc" id="agroup___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s_html_ga982b564879d1dc60a3be787409df0c27"><div class="ttname"><a href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga982b564879d1dc60a3be787409df0c27">SPI_CR1_LSBFIRST_Pos</a></div><div class="ttdeci">#define SPI_CR1_LSBFIRST_Pos</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00382">stm32f407xx_spi.h:382</a></div></div>
<div class="ttc" id="agroup___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s_html_gab07c9facbfdb0a7d5d89b1fd6a3ef711"><div class="ttname"><a href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gab07c9facbfdb0a7d5d89b1fd6a3ef711">SPI_CR1_BIDIMODE_Pos</a></div><div class="ttdeci">#define SPI_CR1_BIDIMODE_Pos</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00390">stm32f407xx_spi.h:390</a></div></div>
<div class="ttc" id="agroup___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s_html_gab2909290fab17ee930afc335811f574c"><div class="ttname"><a href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gab2909290fab17ee930afc335811f574c">SPI_CR1_SSM_Pos</a></div><div class="ttdeci">#define SPI_CR1_SSM_Pos</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00384">stm32f407xx_spi.h:384</a></div></div>
<div class="ttc" id="agroup___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s_html_gadd3274c0dce6293370773c5050f9c4be"><div class="ttname"><a href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gadd3274c0dce6293370773c5050f9c4be">SPI_CR1_CPOL_Pos</a></div><div class="ttdeci">#define SPI_CR1_CPOL_Pos</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00378">stm32f407xx_spi.h:378</a></div></div>
<div class="ttc" id="agroup___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s_html_gadd702fae4dcca65f3b43b2e02f67ee7b"><div class="ttname"><a href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#gadd702fae4dcca65f3b43b2e02f67ee7b">SPI_CR1_RXONLY_Pos</a></div><div class="ttdeci">#define SPI_CR1_RXONLY_Pos</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00385">stm32f407xx_spi.h:385</a></div></div>
<div class="ttc" id="agroup___s_p_i___c_r2___b_i_t___p_o_s_i_t_i_o_n_s_html_gaa0d0f5f51a5804e1a204bf1643516896"><div class="ttname"><a href="group___s_p_i___c_r2___b_i_t___p_o_s_i_t_i_o_n_s.html#gaa0d0f5f51a5804e1a204bf1643516896">SPI_CR2_SSOE_Pos</a></div><div class="ttdeci">#define SPI_CR2_SSOE_Pos</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00408">stm32f407xx_spi.h:408</a></div></div>
<div class="ttc" id="astruct_s_p_ix___config__t_html_a0d54bb16c7b59c8894f9c27f2061c232"><div class="ttname"><a href="struct_s_p_ix___config__t.html#a0d54bb16c7b59c8894f9c27f2061c232">SPIx_Config_t::SPI_BUS_MODE</a></div><div class="ttdeci">uint8_t SPI_BUS_MODE</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00144">stm32f407xx_spi.h:144</a></div></div>
<div class="ttc" id="astruct_s_p_ix___config__t_html_a192d86623e71d56bbbbf99b8efffd298"><div class="ttname"><a href="struct_s_p_ix___config__t.html#a192d86623e71d56bbbbf99b8efffd298">SPIx_Config_t::SPI_CLOCK_SPEED</a></div><div class="ttdeci">uint8_t SPI_CLOCK_SPEED</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00145">stm32f407xx_spi.h:145</a></div></div>
<div class="ttc" id="astruct_s_p_ix___config__t_html_a207736f784d8a45e51344760a1e2163f"><div class="ttname"><a href="struct_s_p_ix___config__t.html#a207736f784d8a45e51344760a1e2163f">SPIx_Config_t::SPI_CRC_EN</a></div><div class="ttdeci">uint8_t SPI_CRC_EN</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00152">stm32f407xx_spi.h:152</a></div></div>
<div class="ttc" id="astruct_s_p_ix___config__t_html_a36304b6c78174800ccd32eb837da0754"><div class="ttname"><a href="struct_s_p_ix___config__t.html#a36304b6c78174800ccd32eb837da0754">SPIx_Config_t::SPI_BIT_ORDER</a></div><div class="ttdeci">uint8_t SPI_BIT_ORDER</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00150">stm32f407xx_spi.h:150</a></div></div>
<div class="ttc" id="astruct_s_p_ix___config__t_html_a57dd078d1351d4a0a54b79ea5a2e08cb"><div class="ttname"><a href="struct_s_p_ix___config__t.html#a57dd078d1351d4a0a54b79ea5a2e08cb">SPIx_Config_t::SPI_SSOE</a></div><div class="ttdeci">uint8_t SPI_SSOE</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00151">stm32f407xx_spi.h:151</a></div></div>
<div class="ttc" id="astruct_s_p_ix___config__t_html_a58ec8a46f301546f865e2e7477bf3d8f"><div class="ttname"><a href="struct_s_p_ix___config__t.html#a58ec8a46f301546f865e2e7477bf3d8f">SPIx_Config_t::SPI_DEVICE_MODE</a></div><div class="ttdeci">uint8_t SPI_DEVICE_MODE</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00143">stm32f407xx_spi.h:143</a></div></div>
<div class="ttc" id="astruct_s_p_ix___config__t_html_a649f465ce3b2a3c787a6f5495770e1fa"><div class="ttname"><a href="struct_s_p_ix___config__t.html#a649f465ce3b2a3c787a6f5495770e1fa">SPIx_Config_t::SPI_FRAME_SIZE</a></div><div class="ttdeci">uint8_t SPI_FRAME_SIZE</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00148">stm32f407xx_spi.h:148</a></div></div>
<div class="ttc" id="astruct_s_p_ix___config__t_html_a908cc1f30a9b3d2603b9c904fa16087b"><div class="ttname"><a href="struct_s_p_ix___config__t.html#a908cc1f30a9b3d2603b9c904fa16087b">SPIx_Config_t::SPI_CPOL</a></div><div class="ttdeci">uint8_t SPI_CPOL</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00146">stm32f407xx_spi.h:146</a></div></div>
<div class="ttc" id="astruct_s_p_ix___config__t_html_a9d287666eb349733ac55fd6317aa7cc3"><div class="ttname"><a href="struct_s_p_ix___config__t.html#a9d287666eb349733ac55fd6317aa7cc3">SPIx_Config_t::SPI_SSM_SETTING</a></div><div class="ttdeci">uint8_t SPI_SSM_SETTING</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00149">stm32f407xx_spi.h:149</a></div></div>
<div class="ttc" id="astruct_s_p_ix___config__t_html_aa1c544b092454a095481cce8672dd4d5"><div class="ttname"><a href="struct_s_p_ix___config__t.html#aa1c544b092454a095481cce8672dd4d5">SPIx_Config_t::SPI_CPHA</a></div><div class="ttdeci">uint8_t SPI_CPHA</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00147">stm32f407xx_spi.h:147</a></div></div>
<div class="ttc" id="astruct_s_p_ix___handle__t_html_a2139a08270d0669a4bfd52184169f444"><div class="ttname"><a href="struct_s_p_ix___handle__t.html#a2139a08270d0669a4bfd52184169f444">SPIx_Handle_t::pSPIx</a></div><div class="ttdeci">SPIx_RegDef_t * pSPIx</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00165">stm32f407xx_spi.h:165</a></div></div>
<div class="ttc" id="astruct_s_p_ix___handle__t_html_ad8dfc166a5c690bfebcc6e855132e805"><div class="ttname"><a href="struct_s_p_ix___handle__t.html#ad8dfc166a5c690bfebcc6e855132e805">SPIx_Handle_t::SPI_CONFIG</a></div><div class="ttdeci">SPIx_Config_t SPI_CONFIG</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00166">stm32f407xx_spi.h:166</a></div></div>
<div class="ttc" id="astruct_s_p_ix___reg_def__t_html"><div class="ttname"><a href="struct_s_p_ix___reg_def__t.html">SPIx_RegDef_t</a></div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00720">stm32f407xx.h:721</a></div></div>
<div class="ttc" id="astruct_s_p_ix___reg_def__t_html_ac806058f093a3e33457f2acd149e73b9"><div class="ttname"><a href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">SPIx_RegDef_t::CR1</a></div><div class="ttdeci">volatile uint32_t CR1</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00722">stm32f407xx.h:722</a></div></div>
<div class="ttc" id="astruct_s_p_ix___reg_def__t_html_ae19a6b4335672191e29e0e1526e27fb0"><div class="ttname"><a href="struct_s_p_ix___reg_def__t.html#ae19a6b4335672191e29e0e1526e27fb0">SPIx_RegDef_t::CR2</a></div><div class="ttdeci">volatile uint32_t CR2</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00723">stm32f407xx.h:723</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ga66a55c39f2954c6fba416822612497cb" name="ga66a55c39f2954c6fba416822612497cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga66a55c39f2954c6fba416822612497cb">&#9670;&#160;</a></span>SPIx_Peri_Control()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIx_Peri_Control </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_p_ix___reg_def__t.html">SPIx_RegDef_t</a> *</td>          <td class="paramname"><span class="paramname"><em>pSPIx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t</td>          <td class="paramname"><span class="paramname"><em>EN_DI</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enables or disables the SPI peripheral. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pSPIx</td><td>: Pointer to the SPI peripheral base address (e.g., SPI1, SPI2, SPI3).</td></tr>
    <tr><td class="paramname">EN_DI</td><td>: Enable/Disable macro. Pass ENABLE to enable SPI peripheral. Pass DISABLE to disable SPI peripheral.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This function sets or clears the SPE bit in SPI_CR1 register.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>None </dd></dl>

<p class="definition">Definition at line <a class="el" href="stm32f407xx__spi_8c_source.html#l00128">128</a> of file <a class="el" href="stm32f407xx__spi_8c_source.html">stm32f407xx_spi.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  128</span>                                                           {</div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">if</span>(EN_DI == <a class="code hl_define" href="group___m_i_s_c_e_l_l_a_n_e_o_u_s___m_a_c_r_o_s.html#ga514ad415fb6125ba296793df7d1a468a">ENABLE</a>){</div>
<div class="line"><span class="lineno">  130</span>        pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> |= (1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga3f5515b536f82c1d91a64bd534030284">SPI_CR1_SPE_Pos</a>);</div>
<div class="line"><span class="lineno">  131</span>    }<span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  132</span>        <span class="comment">//  1. Wait until TXE=1</span></div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">while</span>(!<a class="code hl_function" href="#ga28c21c2e8a6f53982ec6666fb0969123">SPIx_GetFlagStatus</a>(pSPIx, <a class="code hl_define" href="group___s_p_i___s_t_a_t_u_s___f_l_a_g___m_a_c_r_o_s.html#ga13cea6befcaaeb6421eb7e801abb48fe">SPI_STATUS_FLAG_TXE</a>));</div>
<div class="line"><span class="lineno">  134</span>        <span class="comment">//  2. Then wait until BSY=0</span></div>
<div class="line"><span class="lineno">  135</span>        <span class="keywordflow">while</span>(<a class="code hl_function" href="#ga28c21c2e8a6f53982ec6666fb0969123">SPIx_GetFlagStatus</a>(pSPIx, <a class="code hl_define" href="group___s_p_i___s_t_a_t_u_s___f_l_a_g___m_a_c_r_o_s.html#ga891a0e21281996b5ea7421f13182d5b6">SPI_STATUS_FLAG_BSY</a>));</div>
<div class="line"><span class="lineno">  136</span>        <span class="comment">//  3. The Disable the SPI</span></div>
<div class="line"><span class="lineno">  137</span>        pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp;= ~(1 &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga3f5515b536f82c1d91a64bd534030284">SPI_CR1_SPE_Pos</a>);</div>
<div class="line"><span class="lineno">  138</span>    }</div>
<div class="line"><span class="lineno">  139</span>}</div>
<div class="ttc" id="agroup___m_i_s_c_e_l_l_a_n_e_o_u_s___m_a_c_r_o_s_html_ga514ad415fb6125ba296793df7d1a468a"><div class="ttname"><a href="group___m_i_s_c_e_l_l_a_n_e_o_u_s___m_a_c_r_o_s.html#ga514ad415fb6125ba296793df7d1a468a">ENABLE</a></div><div class="ttdeci">#define ENABLE</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00021">stm32f407xx.h:21</a></div></div>
<div class="ttc" id="agroup___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_html_ga28c21c2e8a6f53982ec6666fb0969123"><div class="ttname"><a href="#ga28c21c2e8a6f53982ec6666fb0969123">SPIx_GetFlagStatus</a></div><div class="ttdeci">uint8_t SPIx_GetFlagStatus(SPIx_RegDef_t *pSPIx, uint32_t FlagName)</div><div class="ttdoc">Reads the status of a specific SPI status flag.</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8c_source.html#l00141">stm32f407xx_spi.c:141</a></div></div>
<div class="ttc" id="agroup___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s_html_ga3f5515b536f82c1d91a64bd534030284"><div class="ttname"><a href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga3f5515b536f82c1d91a64bd534030284">SPI_CR1_SPE_Pos</a></div><div class="ttdeci">#define SPI_CR1_SPE_Pos</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00381">stm32f407xx_spi.h:381</a></div></div>
<div class="ttc" id="agroup___s_p_i___s_t_a_t_u_s___f_l_a_g___m_a_c_r_o_s_html_ga13cea6befcaaeb6421eb7e801abb48fe"><div class="ttname"><a href="group___s_p_i___s_t_a_t_u_s___f_l_a_g___m_a_c_r_o_s.html#ga13cea6befcaaeb6421eb7e801abb48fe">SPI_STATUS_FLAG_TXE</a></div><div class="ttdeci">#define SPI_STATUS_FLAG_TXE</div><div class="ttdoc">Transmit buffer empty (bit 1).</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00191">stm32f407xx_spi.h:191</a></div></div>
<div class="ttc" id="agroup___s_p_i___s_t_a_t_u_s___f_l_a_g___m_a_c_r_o_s_html_ga891a0e21281996b5ea7421f13182d5b6"><div class="ttname"><a href="group___s_p_i___s_t_a_t_u_s___f_l_a_g___m_a_c_r_o_s.html#ga891a0e21281996b5ea7421f13182d5b6">SPI_STATUS_FLAG_BSY</a></div><div class="ttdeci">#define SPI_STATUS_FLAG_BSY</div><div class="ttdoc">Busy (bit 7).</div><div class="ttdef"><b>Definition</b> <a href="stm32f407xx__spi_8h_source.html#l00239">stm32f407xx_spi.h:239</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga66a55c39f2954c6fba416822612497cb_cgraph.png" border="0" usemap="#agroup___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga66a55c39f2954c6fba416822612497cb_cgraph" loading="lazy" alt=""/></div>
<map name="agroup___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga66a55c39f2954c6fba416822612497cb_cgraph" id="agroup___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga66a55c39f2954c6fba416822612497cb_cgraph">
<area shape="rect" title="Enables or disables the SPI peripheral." alt="" coords="5,5,135,32"/>
<area shape="rect" href="group___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s.html#ga28c21c2e8a6f53982ec6666fb0969123" title="Reads the status of a specific SPI status flag." alt="" coords="183,5,324,32"/>
<area shape="poly" title=" " alt="" coords="135,16,167,16,167,21,135,21"/>
</map>
</div>

</div>
</div>
<a id="ga2f1a0a4006270d72092844c3e764d399" name="ga2f1a0a4006270d72092844c3e764d399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2f1a0a4006270d72092844c3e764d399">&#9670;&#160;</a></span>SPIx_SendData_Blocking()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void SPIx_SendData_Blocking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_s_p_ix___reg_def__t.html">SPIx_RegDef_t</a> *</td>          <td class="paramname"><span class="paramname"><em>pSPIx</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>pData</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t</td>          <td class="paramname"><span class="paramname"><em>Len</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send data over the specified SPI peripheral. </p>
<p>This function transmits a block of data through the given SPI instance. It writes the provided buffer into the SPI data register until the specified length is sent.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pSPIx</td><td>Pointer to the SPI peripheral register definition structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pData</td><td>Pointer to the data buffer containing bytes to be transmitted. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Len</td><td>Length of the data buffer in bytes.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>This is a blocking call. The function waits until all data has been transmitted before returning.</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">None</td><td></td></tr>
  </table>
  </dd>
</dl>
<p>After writing ALL data, wait for: TXE = 1  DR empty BSY = 0  last bit fully shifted out</p>

<p class="definition">Definition at line <a class="el" href="stm32f407xx__spi_8c_source.html#l00145">145</a> of file <a class="el" href="stm32f407xx__spi_8c_source.html">stm32f407xx_spi.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  145</span>                                                                               {</div>
<div class="line"><span class="lineno">  146</span>    <span class="keywordflow">while</span>(Len&gt;0){</div>
<div class="line"><span class="lineno">  147</span>        <span class="comment">// Wait until TXE = 1</span></div>
<div class="line"><span class="lineno">  148</span>        <span class="keywordflow">while</span> (!<a class="code hl_function" href="#ga28c21c2e8a6f53982ec6666fb0969123">SPIx_GetFlagStatus</a>(pSPIx, <a class="code hl_define" href="group___s_p_i___s_t_a_t_u_s___f_l_a_g___m_a_c_r_o_s.html#ga13cea6befcaaeb6421eb7e801abb48fe">SPI_STATUS_FLAG_TXE</a>));</div>
<div class="line"><span class="lineno">  149</span>        <span class="comment">//Check the data format</span></div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">if</span>(pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#ac806058f093a3e33457f2acd149e73b9">CR1</a> &amp; (1U &lt;&lt; <a class="code hl_define" href="group___s_p_i___c_r1___b_i_t___p_o_s_i_t_i_o_n_s.html#ga5290662db14690d4bcf30ed9e4694462">SPI_CR1_DFF_Pos</a>)){<span class="comment">// Frame Size = 16</span></div>
<div class="line"><span class="lineno">  151</span>            pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#aa59c17ad248dcbd0b66bc5aaa64c070f">DR</a> = *((uint16_t*) pData);</div>
<div class="line"><span class="lineno">  152</span>            pData += 2;</div>
<div class="line"><span class="lineno">  153</span>            Len -= 2;</div>
<div class="line"><span class="lineno">  154</span>        }<span class="keywordflow">else</span>{<span class="comment">// Frame Size = 8</span></div>
<div class="line"><span class="lineno">  155</span>            pSPIx-&gt;<a class="code hl_variable" href="struct_s_p_ix___reg_def__t.html#aa59c17ad248dcbd0b66bc5aaa64c070f">DR</a> = *pData;</div>
<div class="line"><span class="lineno">  156</span>            pData++;</div>
<div class="line"><span class="lineno">  157</span>            Len--;</div>
<div class="line"><span class="lineno">  158</span>        }</div>
<div class="line"><span class="lineno">  159</span>    }</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span></div>
<div class="line"><span class="lineno">  167</span>    <span class="keywordflow">while</span> (!<a class="code hl_function" href="#ga28c21c2e8a6f53982ec6666fb0969123">SPIx_GetFlagStatus</a>(pSPIx, <a class="code hl_define" href="group___s_p_i___s_t_a_t_u_s___f_l_a_g___m_a_c_r_o_s.html#ga13cea6befcaaeb6421eb7e801abb48fe">SPI_STATUS_FLAG_TXE</a>));</div>
<div class="line"><span class="lineno">  168</span>    <span class="keywordflow">while</span>  ( <a class="code hl_function" href="#ga28c21c2e8a6f53982ec6666fb0969123">SPIx_GetFlagStatus</a>(pSPIx, <a class="code hl_define" href="group___s_p_i___s_t_a_t_u_s___f_l_a_g___m_a_c_r_o_s.html#ga891a0e21281996b5ea7421f13182d5b6">SPI_STATUS_FLAG_BSY</a>));</div>
<div class="line"><span class="lineno">  169</span>}</div>
<div class="ttc" id="astruct_s_p_ix___reg_def__t_html_aa59c17ad248dcbd0b66bc5aaa64c070f"><div class="ttname"><a href="struct_s_p_ix___reg_def__t.html#aa59c17ad248dcbd0b66bc5aaa64c070f">SPIx_RegDef_t::DR</a></div><div class="ttdeci">volatile uint32_t DR</div><div class="ttdef"><b>Definition</b> <a href="_s_t_m32_f4xx___d_r_i_v_e_r_s_2_inc_2stm32f407xx_8h_source.html#l00725">stm32f407xx.h:725</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="group___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga2f1a0a4006270d72092844c3e764d399_cgraph.png" border="0" usemap="#agroup___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga2f1a0a4006270d72092844c3e764d399_cgraph" loading="lazy" alt=""/></div>
<map name="agroup___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga2f1a0a4006270d72092844c3e764d399_cgraph" id="agroup___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s_ga2f1a0a4006270d72092844c3e764d399_cgraph">
<area shape="rect" title="Send data over the specified SPI peripheral." alt="" coords="5,5,178,32"/>
<area shape="rect" href="group___s_p_i___a_p_i___p_r_o_t_o_t_y_p_e_s.html#ga28c21c2e8a6f53982ec6666fb0969123" title="Reads the status of a specific SPI status flag." alt="" coords="226,5,367,32"/>
<area shape="poly" title=" " alt="" coords="178,16,210,16,210,21,178,21"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.15.0 </li>
  </ul>
</div>
</body>
</html>
